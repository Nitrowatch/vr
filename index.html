<html>
  <head>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <!-- Sky texture -->
        <img id="skyTex" src="plain_starfield_1.png">
      </a-assets>

      <!-- Sky -->
      <a-sky src="#skyTex"></a-sky>

      <!-- Floating red box -->
      <a-box position="-1 1.5 -3" rotation="0 45 0" color="red"></a-box>

      <!-- Floating green sphere -->
      <a-sphere position="1 2 -4" radius="1" color="green"></a-sphere>

      <!-- Large yellow floor -->
      <a-plane position="0 0 0" rotation="-90 0 0" width="100" height="100" color="yellow"></a-plane>

      <!-- Camera rig -->
      <a-entity id="rig" position="0 1.6 0">
        <a-entity id="playerCam" camera look-controls></a-entity>
      </a-entity>
    </a-scene>

    <script>
      const rig = document.querySelector('#rig');
      const camera = document.querySelector('#playerCam');

      const speed = 1.5; // movement speed in units per second
      let lastTime = null;

      // Move rig forward based on camera rotation
      function moveForward(delta) {
        const rotation = camera.object3D.rotation;
        rig.object3D.position.z -= Math.cos(rotation.y) * speed * delta;
        rig.object3D.position.x -= Math.sin(rotation.y) * speed * delta;
      }

      // Smooth frame-based movement
      function animate(time) {
        if (!lastTime) lastTime = time;
        const delta = (time - lastTime) / 1000; // seconds
        lastTime = time;

        const pitch = THREE.MathUtils.radToDeg(camera.object3D.rotation.x);
        if (pitch < -20) { // look down threshold
          moveForward(delta);
        }

        requestAnimationFrame(animate);
      }

      requestAnimationFrame(animate);
    </script>
  </body>
</html>
